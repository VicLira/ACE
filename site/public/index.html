<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACE - Aliance of Create Effort</title>

    <script src="./js/funcoes.js"></script>

    <link rel="stylesheet" href="./css/geral.css">
    <link rel="stylesheet" href="./css/home.css">
    <link rel="stylesheet" href="./css/games-carousel.css">
    <link rel="stylesheet" href="./css/gamers.css">
    <link rel="stylesheet" href="./css/news.css">
    <link rel="stylesheet" href="./css/navigations.css">
    <link rel="stylesheet" href="./css/footer.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Krona+One&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <header class="navbar">

        <div class="container">
            <div class="nav">
                <div class="nav-item">
                    <a href="#"><img src="./assets/ACE-removedbg.png" alt="" class="logo"></a>
                </div>
                <div class="nav-item">
                    |
                </div>
                <div class="nav-item">
                    <div class="search-wrapper">
                        <input type="text" class="search">
                        <button class="search-btn">Submit</button>
                    </div>
                </div>
            </div>

            <nav class="nav-btn">
                <div class="nav-item">
                    <a href="./login.html" class="primary-btn">Login</a>

                </div>
                <div class="nav-item">
                    <a href="./cadastro.html" class="primary-btn">Cadastro</a>
                </div>
            </nav>
        </div>
    </header>

    <aside>
        <div class="sidebar">
            <div class="container">
                <ul class="side-nav" id="sideNav">
                    <li class="side-item">

                        <a href="#" class="side-link">
                            <i class="fa-solid fa-house-chimney"></i>
                            home
                        </a>

                    </li>
                    <li class="side-item">
                        <a href="#" class="side-link">
                          <i class="fa-solid fa-user"></i>
                            perfil
                        </a>
          
                    </li>
                    <li class="side-item">
                        <a href="./postJogo/index.html" class="side-link">
                            <i class="fa-solid fa-gamepad"></i>
                            Adicionar jogo
                        </a>

                    </li>
                    <li class="side-item">
                        <a href="./postNoticia/index.html" class="side-link">
                            <i class="fa-solid fa-newspaper"></i>
                            Adicionar noticia
                        </a>

                    </li>
                </ul>
            </div>
        </div>
    </aside>

    <section id="home">
        <div class="gradient-overlay"></div>
        <div class="container">
            <div class="home-text">
                <div class="home-title">
                    <p class="secondary-legend">Descubra novos jogos!</p>
                    <h1 class="primary-title">Explore um novo <span>MUNDO</span>! </h1>
                </div>
                <button class="primary-btn">Descobrir AGORA</button>
            </div>
        </div>
    </section>

    <section id="games-carousel">
        <div class="container">
            <div class="section-title">
                <h2 class="secondary-title">Jogos mais jogados</h2>
                <button class="primary-btn">Ver todos</button>
            </div>

            <div class="carousel" id="carousel">
                <!-- <div class="carousel-item">
                    <div class="gradient-overlay"></div>
                    <img class="game-bg" src="./assets/jogo-1.png" alt="">

                    <div class="likes">
                        <img src="" alt="">
                        <span class="legend">1000 curtidas</span>
                    </div>
                </div>
                <div class="carousel-item">
                    <div class="gradient-overlay"></div>
                    <img class="game-bg" src="./assets/jogo-2.png" alt="">

                    <div class="likes">
                        <img src="" alt="">
                        <span class="legend">1000 curtidas</span>
                    </div>
                </div>
                <div class="carousel-item">
                    <div class="gradient-overlay"></div>
                    <img class="game-bg" src="./assets/jogo-3.png" alt="">

                    <div class="likes">
                        <img src="" alt="">
                        <span class="legend">1000 curtidas</span>
                    </div>
                </div>
                <div class="carousel-item">
                    <div class="gradient-overlay"></div>
                    <img class="game-bg" src="./assets/jogo-4.png" alt="">

                    <div class="likes">
                        <img src="" alt="">
                        <span class="legend">1000 curtidas</span>
                    </div>
                </div>
            </div> -->

                <img class="character" src="./assets/celeste.png" alt="">
            </div>
    </section>

    <section id="gamers">
        <div class="container" id="containerGamers">
            <!-- <div class="gamer">
                <img src="./assets/user-img-default.png" alt="">
                <span class="legend">Gamer</span>
            </div>
            <div class="gamer">
                <img src="./assets/user-img-default.png" alt="">
                <span class="legend">Gamer</span>
            </div>
            <div class="gamer">
                <img src="./assets/user-img-default.png" alt="">
                <span class="legend">Gamer</span>
            </div>
            <div class="gamer">
                <img src="./assets/user-img-default.png" alt="">
                <span class="legend">Gamer</span>
            </div>
            <div class="gamer">
                <img src="./assets/user-img-default.png" alt="">
                <span class="legend">Gamer</span>
            </div> -->

            <img class="character" src="./assets/cavaleiro.png" alt="">
        </div>

    </section>

    <section id="news">
        <div class="overlay"></div>
        <div class="container">
            <div class="section-title">
                <h2 class="secondary-title">Jogos mais jogados</h2>
                <button class="primary-btn">Ver todos</button>
            </div>

            <div class="row">
                <div class="col">
                    <div class="primary-new">
                        <div class="new-info">
                            <div class="banner"></div>
                            <div class="info-text">
                                <h3 class="tertiary-title">News title</h3>
                                <p class="secondary-legend">News legend</p>
                            </div>

                        </div>

                    </div>
                </div>
                <div class="col">
                    <div class="secondary-new">
                        <div class="new-info">
                            <div class="banner"></div>
                            <div class="info-text">
                                <h3 class="tertiary-title">News title</h3>
                                <p class="secondary-legend">News legend</p>
                            </div>

                        </div>

                    </div>
                    <div class="secondary-new">
                        <div class="new-info">
                            <div class="banner"></div>
                            <div class="info-text">
                                <h3 class="tertiary-title">News title</h3>
                                <p class="secondary-legend">News legend</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer id="footer">
        <div class="container">
            <div class="col">
                <h2 class="secondary-title">Sobre</h2>
                <ul class="list-links">
                    <li class="list-item">+55 (11) 99999-9999</li>
                    <li class="list-item">Endereço</li>
                    <li class="list-item">ace@contato.com</li>
                    <img src="./assets/ACE-removedbg.png" class="logo" alt="">
                </ul>
            </div>
            <div class="col">
                <h2 class="secondary-title">Quero Jogar:</h2>
                <ul class="list-links">
                    <li><a href="#" class="list-item">Terror</a></li>
                    <li><a href="#" class="list-item">Aventura</a></li>
                    <li><a href="#" class="list-item">Plataforma</a></li>
                    <li><a href="#" class="list-item">Puzzle</a></li>
                    <li><a href="#" class="list-item">RPG</a></li>
                    <li><a href="#" class="list-item">Simulador</a></li>
                </ul>
            </div>
            <div class="col">
                <h2 class="secondary-title">Comunidade:</h2>
                <ul class="list-links">
                    <li><a href="#" class="list-item">Comunidade</a></li>
                    <li><a href="#" class="list-item">Blog</a></li>
                    <li><a href="#" class="list-item">Discord</a></li>
                </ul>

            </div>
        </div>
    </footer>
</body>

</html>

<script>
    window.onload = () => {
        carregarFuncoesUsuario();
        obterDadosEPlotar();
    };

    function buscarJogosMaisFamosos(qtdLinhasVar) {
        fetch(`/jogos/buscarJogosMaisFamosos/${qtdLinhasVar}`, {
            method: "GET",
            headers: {
                "Content-Type": "application/json"
            }
        }).then(function (response) {
            if (response.ok) {
                response.json()
                    .then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                        // Chame a função para plotar o gráfico aqui
                        plotarFeed(resposta);
                    });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    function buscarUsuarios(qtdLinhasVar) {
        fetch(`/usuarios/buscarUsuarios/${qtdLinhasVar}`, {
            method: "GET",
            headers: {
                "Content-Type": "application/json"
            }
        }).then(function (response) {
            if (response.ok) {
                response.json()
                    .then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                        // Chame a função para plotar o gráfico aqui
                        plotarUsuarios(resposta);
                    });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }


    // Função para obter os dados do servidor e plotar o gráfico
    function obterDadosEPlotar() {
        buscarJogosMaisFamosos(4);
        buscarUsuarios(5);
    }


    // Função para plotar o gráfico de linhas
    function plotarFeed(resposta) {
        // Preenchendo os arrays com os dados recebidos
    carousel.innerHTML += resposta.map(function (registro) {
        const imagemJogo = registro.banner ? registro.banner : 'game-default.png';
        const qtdCurtida = registro.qtdCurtida ? registro.qtdCurtida : 0;

        return `<div class="carousel-item" data-id="${registro.idJogo}">
            
            <div class="game-bg-wrapper">
                <img class="game-bg" src="./assets/jogosImgs/${imagemJogo}" alt="">
                <div class="gradient-overlay"></div>
            </div>
            

            <div class="likes">
                <i class="fa-solid fa-fire"></i>
                <div class="col"> 
                    <div class="row"> 
                        <span class="legend">${registro.nomeJogo}</span>
                    </div>

                    <div class="row"> 
                        
                        <span class="legend">${qtdCurtida} Curtidas</span>
                    </div>
                </div>
            </div>
        </div>`;
    }).join('');

        // Adiciona um evento de clique aos elementos do carousel
        const carouselItems = document.querySelectorAll('.carousel-item');
        carouselItems.forEach(function (item) {
            item.addEventListener('click', function () {
            // Obtenha o ID do jogo a partir do atributo "data-id"
            const jogoId = item.getAttribute('data-id');

            // Armazene o ID do jogo na sessionStorage
            sessionStorage.setItem('jogoId', jogoId);

            // Redirecione para a página de detalhes do jogo
            window.location = './detalhesJogo';
            });
        });
    }

    // Função para plotar o gráfico de linhas
    function plotarUsuarios(resposta) {
        // Preenchendo os arrays com os dados recebidos
        containerGamers.innerHTML += resposta.map(function (registro) {
        const imgUser = registro.imgUser ? registro.imgUser : 'user-img-default.png';

            return `<div class="gamer">
                    <img src="./assets/ftPerfil/${imgUser}" alt="">
                    <span class="legend">${registro.nome}</span>
                </div>`;
            }).join('');
        }


</script>